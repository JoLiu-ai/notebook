# 事实笔记本 - 浏览器插件

一个用于阅读网页/帖子时保存网址、文本和图片的事实笔记工具。

## 功能特性

- ✅ **保存网址**：自动记录当前页面网址
- ✅ **保存文本**：支持手动输入或自动提取页面文本
- ✅ **保存图片**：支持上传图片或从页面提取图片
- ✅ **快速搜索**：通过标题、内容或网址搜索笔记
- ✅ **本地存储**：所有数据保存在浏览器本地，保护隐私
- ✅ **一键捕获**：快速捕获当前页面的文本和图片
- ✅ **自动保存**：输入文本内容时，停止输入 2 秒后自动保存（防抖）
- ✅ **右键菜单**：右键选中文本、图片、链接或页面空白处，快速保存到笔记
- ✅ **多格式导出**：支持导出为 JSON、Markdown、PDF、DOCX 格式
- ✅ **侧边栏模式**：支持侧边栏和弹窗两种使用模式
- ✅ **数据导入导出**：支持 JSON 格式的数据导入和导出
- ✅ **文档库视图**：提供笔记统计和文档库管理功能

## 安装方法

### 第一步：生成图标（必需）

在加载插件之前，需要先生成图标文件：

**方法一：使用内置图标生成器（推荐）**
1. 在浏览器中打开 `generate-icons.html` 文件
2. 点击"生成图标"按钮
3. 分别下载三个尺寸的图标文件
4. 将下载的文件重命名为 `icon16.png`、`icon48.png`、`icon128.png`
5. 将文件放入 `icons` 文件夹

**方法二：使用在线工具**
1. 访问 https://www.favicon-generator.org/
2. 上传一个图标图片（建议 512x512）
3. 下载生成的图标文件到 `icons` 文件夹

**方法三：使用占位图标**
如果没有图标，可以创建三个纯色 PNG 图片（16x16、48x48、128x128），保存到 `icons` 文件夹。

### 第二步：加载插件

1. 打开 Chrome 浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择本插件的文件夹（`fact-notebook-extension`）
6. 完成安装

### 方法二：打包安装

1. 在 `chrome://extensions/` 页面点击"打包扩展程序"
2. 选择本插件文件夹
3. 生成 `.crx` 文件后安装

## 使用方法

### 添加笔记

**方法一：通过插件界面**
1. 点击浏览器工具栏中的插件图标（弹窗模式）或侧边栏图标（侧边栏模式）
2. 顶部标签可在“笔记 / 文档库”之间切换查看统计与列表
3. 点击"添加笔记"按钮
4. 填写笔记信息：
   - **标题**：笔记标题（可选）
   - **网址**：自动填充当前页面网址
   - **文本内容**：手动输入或点击"捕获当前页面"自动提取
   - **图片**：点击"选择图片"上传，或使用"捕获当前页面"提取页面图片
4. 点击"保存"完成，或等待 2 秒自动保存

**方法二：通过右键菜单（推荐）**
1. 在网页中选中文本、图片、链接，或直接在页面空白处右键
2. 右键点击，选择"保存到事实笔记本"
3. 笔记会自动保存，包含选中的内容或当前页面内容

### 查看笔记

- 在插件弹窗中可以看到所有笔记列表
- 点击笔记卡片查看详细信息
- 点击笔记中的网址可以在新标签页打开原网页
- 点击图片可以查看大图

### 搜索笔记

- 在搜索框中输入关键词
- 支持搜索标题、内容和网址

### 编辑笔记

- 在查看笔记详情时，点击"编辑"按钮
- 修改笔记内容后点击"更新"保存

### 删除笔记

- 在查看笔记详情时，点击"删除"按钮
- 确认后即可删除

### 导出笔记

1. 点击插件界面中的"导出"按钮（📥 图标）
2. 选择导出格式：
   - **JSON**：原始数据格式，支持导入
   - **Markdown**：Markdown 格式，适合文档编辑
   - **PDF**：PDF 文档，使用浏览器打印功能
   - **DOCX**：Word 文档格式（HTML 格式，可在 Word 中打开）
3. 文件会自动下载

### 导入笔记

1. 点击插件界面中的"导入"按钮（📤 图标）
2. 选择之前导出的 JSON 文件
3. 数据会自动导入并合并到现有笔记中

### 自动保存功能

- 在编辑笔记时，输入文本内容后停止输入 2 秒会自动保存
- 无需手动点击保存按钮
- 关闭弹窗时会清除自动保存定时器

## 项目结构

```
fact-notebook-extension/
├── manifest.json          # 插件配置文件
├── popup.html            # 弹窗 HTML
├── popup.css             # 弹窗样式
├── popup.js              # 弹窗逻辑
├── sidebar.html          # 侧边栏 HTML
├── sidebar.css           # 侧边栏样式
├── sidebar.js            # 侧边栏逻辑
├── content.js            # 内容脚本（提取网页内容）
├── background.js          # 后台脚本（右键菜单、消息处理）
├── storage.js             # 数据存储管理
├── icons/                # 图标文件夹
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
├── generate-icons.html   # 图标生成工具（HTML）
├── generate-icons.py     # 图标生成工具（Python）
└── README.md             # 说明文档
```

## 技术实现

- **Manifest V3**：使用最新的 Chrome 扩展 API
- **Chrome Storage API**：本地存储笔记数据
- **Content Scripts**：从网页提取内容
- **Context Menus API**：右键菜单功能
- **Base64 编码**：图片以 base64 格式存储
- **防抖（Debounce）**：自动保存功能使用防抖技术
- **Flexbox 布局**：响应式布局，支持侧边栏和弹窗模式

## 数据存储

所有笔记数据存储在浏览器的 `chrome.storage.local` 中，包括：
- 笔记标题
- 网址
- 文本内容
- 图片（base64 格式）
- 创建时间
- 更新时间

## 注意事项

1. **图片大小限制**：由于使用 base64 存储，建议不要添加过多或过大的图片
2. **跨域图片**：某些跨域图片可能无法提取，这是浏览器的安全限制
3. **数据备份**：建议定期使用导出功能备份数据
4. **自动保存**：自动保存功能仅在编辑文本内容时触发，修改标题或网址需要手动保存
5. **PDF 导出**：PDF 导出使用浏览器打印功能，需要用户手动选择"另存为 PDF"
6. **DOCX 导出**：导出的 DOCX 文件实际上是 HTML 格式，可以在 Microsoft Word 中打开并另存为真正的 DOCX 格式

## 快速生成图标

### 方法一：使用 Python 脚本（推荐）

```bash
# 安装依赖
pip install Pillow

# 运行脚本
python generate-icons.py
```

### 方法二：使用 HTML 工具

1. 在浏览器中打开 `generate-icons.html`
2. 点击"生成图标"按钮
3. 下载生成的图标文件到 `icons` 文件夹

## 后续计划

- [x] 添加编辑笔记功能
- [x] 支持导出为 JSON
- [x] 支持导出为 Markdown
- [x] 支持导出为 PDF
- [x] 支持导出为 DOCX
- [x] 支持导入数据
- [x] 添加自动保存功能（防抖）
- [x] 添加右键菜单快速保存
- [x] 侧边栏模式
- [x] 文档库视图
- [ ] 添加分类和标签功能
- [ ] 支持数据同步（可选）
- [ ] 优化图片存储方式
- [ ] 添加快捷键支持
- [ ] 支持全文搜索
- [ ] 支持笔记模板

## 开发

### 修改代码后重新加载

1. 在 `chrome://extensions/` 页面
2. 找到"事实笔记本"插件
3. 点击刷新图标重新加载

### 调试

- **Popup 调试**：右键点击插件图标 → 检查弹出内容
- **Sidebar 调试**：在侧边栏中按 F12，或右键点击侧边栏 → 检查
- **Content Script 调试**：在网页中按 F12，在 Console 中查看
- **Background 调试**：在 `chrome://extensions/` 页面点击"service worker"链接

### 使用模式

插件支持两种使用模式：

1. **弹窗模式**：点击插件图标打开弹窗（popup.html）
2. **侧边栏模式**：在网页中打开侧边栏（sidebar.html），可以调整大小和位置

## 许可证

MIT License
